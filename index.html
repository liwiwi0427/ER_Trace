<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECG Pro V12.0 - Medical Standard</title>
    <link rel="stylesheet" href="style.css">
    <script>
        if (!localStorage.getItem('ecg_username')) { window.location.replace('login.html'); }
    </script>
</head>
<body>

<aside>
    <div class="brand">
        <span>âš¡ ECG Pro</span>
        <span class="ver-badge">V12.0</span>
    </div>
    
    <div class="theme-selector">
        <label>ğŸ¨ ä»‹é¢é¢¨æ ¼</label>
        <select id="theme-select" onchange="changeTheme(this.value)">
            <option value="dark">ğŸ¥ å°ˆæ¥­é†«ç™‚é»‘ (Clinical Dark)</option>
            <option value="light">â˜€ï¸ æ—¥é–“ç—…æˆ¿ç™½ (Day Light)</option>
            <option value="retro">ğŸ“º å¾©å¤è¢å…‰ (Retro CRT)</option>
            <option value="cyber">ğŸ¤– è³½åšæœªä¾† (Cyberpunk)</option>
        </select>
    </div>

    <div class="nav-scroll">
        <div class="nav-category">Sinus (ç«‡æ€§)</div>
        <div class="nav-btn active" onclick="loadCase('nsr')"><span>NSR æ­£å¸¸ç«‡æ€§</span><div class="dot norm"></div></div>
        <div class="nav-btn" onclick="loadCase('sb')"><span>Sinus Brady ç·©è„ˆ</span><div class="dot norm"></div></div>
        
        <div class="nav-category">Atrial (æˆ¿æ€§)</div>
        <div class="nav-btn" onclick="loadCase('psvt')"><span>PSVT å®¤ä¸Šé€Ÿ</span><div class="dot warn"></div></div>
        <div class="nav-btn" onclick="loadCase('afib')"><span>AFib æˆ¿é¡«</span><div class="dot warn"></div></div>
        <div class="nav-btn" onclick="loadCase('afl')"><span>A-Flutter æˆ¿æ’²</span><div class="dot warn"></div></div>

        <div class="nav-category">Ventricular (å®¤æ€§)</div>
        <div class="nav-btn" onclick="loadCase('pvc')"><span>PVC å®¤æ—©æ”¶</span><div class="dot warn"></div></div>
        <div class="nav-btn" onclick="loadCase('vt_pulse')"><span>VT (Pulse)</span><div class="dot crit"></div></div>
        <div class="nav-btn" onclick="loadCase('vt_pulseless')"><span>pVT (No Pulse)</span><div class="dot crit"></div></div>
        <div class="nav-btn" onclick="loadCase('tdp')"><span>TdP æ‰­è½‰æ³¢</span><div class="dot crit"></div></div>
        <div class="nav-btn" onclick="loadCase('vf')"><span>VF å®¤é¡«</span><div class="dot crit"></div></div>

        <div class="nav-category">Blocks & Arrest</div>
        <div class="nav-btn" onclick="loadCase('avb1')"><span>1st Degree AVB</span><div class="dot spec"></div></div>
        <div class="nav-btn" onclick="loadCase('avb2t1')"><span>2nd Degree I</span><div class="dot spec"></div></div>
        <div class="nav-btn" onclick="loadCase('avb2t2')"><span>2nd Degree II</span><div class="dot spec"></div></div>
        <div class="nav-btn" onclick="loadCase('avb3')"><span>3rd Degree AVB</span><div class="dot spec"></div></div>
        <div class="nav-btn" onclick="loadCase('pea')"><span>PEA ç„¡è„ˆé›»æ°£</span><div class="dot crit"></div></div>
        <div class="nav-btn" onclick="loadCase('asystole')"><span>Asystole å¿ƒå¾‹æ­¢</span><div class="dot crit"></div></div>
    </div>
    
    <div class="sidebar-footer">
        <div class="footer-btn" onclick="openModal()">â„¹ï¸<span>è³‡è¨Š</span></div>
        <div class="footer-btn" onclick="logout()" style="color:var(--st-crit);">ğŸšª<span>ç™»å‡º</span></div>
    </div>
</aside>

<main>
    <div class="top-deck">
        <div class="monitor-frame">
            <div class="monitor-screen">
                <div class="ecg-grid"></div>
                <div class="flash-overlay" id="screen-flash"></div>
                <div class="monitor-overlay">
                    <div class="monitor-header">LEAD II <span class="monitor-mode">Monitor Mode</span></div>
                    <div id="user-staff-badge">Staff: --</div>
                </div>
                <div class="med-log" id="med-log"></div>
                <canvas id="ecgCanvas"></canvas>
            </div>
            <!-- æ•¸å€¼é¢æ¿ï¼šé¡è‰²å·²ä¿®æ­£ -->
            <div class="vitals-panel">
                <div class="vital-row c-hr"><span class="lbl">HR</span><span class="val" id="val-hr">--</span><span class="unit">bpm</span></div>
                <div class="vital-row c-bp">
                    <span class="lbl">NIBP</span>
                    <div class="val-group"><span id="val-sys">--</span>/<span id="val-dia">--</span></div>
                    <button class="nibp-btn" id="btn-nibp" onclick="toggleNIBP()">æ¸¬é‡</button>
                </div>
                <div class="vital-row c-spo2"><span class="lbl">SpO2</span><span class="val" id="val-spo2">--</span><span class="unit">%</span></div>
                <div class="vital-row c-rr"><span class="lbl">RR</span><span class="val" id="val-rr">--</span><span class="unit">rpm</span></div>
            </div>
        </div>

        <div class="control-panel">
            <div class="defib-section">
                <div class="lcd-display"><span id="joule-val">200</span> J</div>
                <div class="defib-controls">
                    <button class="btn-defib btn-charge" id="btn-charge" onclick="charge()">CHARGE</button>
                    <button class="btn-defib btn-shock" id="btn-shock" onclick="shock()" disabled>SHOCK</button>
                </div>
            </div>
            <div class="meds-section">
                <div class="section-title">ACLs Meds</div>
                <div class="meds-grid">
                    <button class="drug-btn d-epi" onclick="giveDrug('epi')">Epi <span>1mg</span></button>
                    <button class="drug-btn d-amio" onclick="giveDrug('amio')">Amio <span>150mg</span></button>
                    <button class="drug-btn d-aden" onclick="giveDrug('adenosine')">Adeno <span>6mg</span></button>
                    <button class="drug-btn d-atro" onclick="giveDrug('atropine')">Atro <span>1mg</span></button>
                    <button class="drug-btn d-mag" onclick="giveDrug('mag')">Mag <span>2g</span></button>
                </div>
            </div>
        </div>
    </div>

    <div class="edu-container">
        <div class="anatomy-box">
            <div class="box-header">Detailed Conduction</div>
            <!-- ä¿®æ­£å¾Œçš„ç²¾ç¢ºè§£å‰–åœ– -->
            <svg class="heart-svg" viewBox="0 0 300 350" style="overflow:visible;">
                <!-- åº•åœ– -->
                <path id="heart-muscle" class="path-heart" d="M150 330 C 50 300, 20 180, 20 120 C 20 60, 80 20, 150 90 C 220 20, 280 60, 280 120 C 280 180, 250 300, 150 330 Z" />
                
                <!-- 1. Internodal Pathways (çµé–“è·¯å¾‘) -->
                <path id="path-internodal" class="path-conduction" d="M80 80 Q 115 110 150 140" data-name="Internodal Pathways (çµé–“è·¯å¾‘)" />
                
                <!-- 2. Bundle of His (å¸Œæ°æŸ) -->
                <path id="path-his" class="path-conduction" d="M150 140 L 150 175" data-name="Bundle of His (å¸Œæ°æŸ)" />
                
                <!-- 3. Bundle Branches (å·¦å³æŸæ”¯/æŸé‡‘æ°) -->
                <path id="path-branches" class="path-conduction" d="M150 175 L 100 260 M 150 175 L 200 260" data-name="Bundle Branches / Purkinje (æŸæ”¯/æŸé‡‘æ°)" />
                
                <!-- Nodes -->
                <circle id="node-sa" class="node" cx="80" cy="80" r="9" data-name="SA Node (ç«‡æˆ¿çµ)" />
                <circle id="node-av" class="node" cx="150" cy="140" r="7" data-name="AV Node (æˆ¿å®¤çµ)" />
                
                <!-- ç•°å¸¸åœ–ç¤º -->
                <rect id="vis-block" class="block-bar" x="135" y="145" width="30" height="8" rx="2" />
                <circle id="vis-psvt" cx="150" cy="140" r="15" class="reentry-ring" style="display:none;"/>
                <g id="vis-tdp" style="display:none;">
                    <circle class="flash-dot" cx="120" cy="220" r="6" />
                    <circle class="flash-dot" cx="180" cy="250" r="6" style="animation-delay:0.2s"/>
                </g>
            </svg>
            <!-- äº’å‹•é¡¯ç¤ºåç¨± -->
            <p id="anatomy-text" style="color:var(--c-spo2); font-size:0.9rem; margin-top:15px; font-weight:bold; height:20px;">Normal Conduction</p>
        </div>

        <div class="content-box">
            <div class="content-header">
                <div class="rhythm-title" id="txt-title">NSR</div>
                <span class="rhythm-tag" id="txt-tag">Normal</span>
            </div>
            <div class="tabs">
                <button class="tab-btn active" onclick="setTab('overview')">ç‰¹å¾µ (Criteria)</button>
                <button class="tab-btn" onclick="setTab('patho')">ç—…ç† (Patho)</button>
                <button class="tab-btn" onclick="setTab('rx')">è™•ç½® (Rx)</button>
            </div>
            <div class="tab-viewport">
                <div id="tab-overview" class="tab-content active">
                    <div id="alert-box"></div>
                    <div class="info-card">
                        <h4>ğŸ“‹ åˆ¤è®€æ¨™æº–</h4>
                        <ul id="list-criteria" class="styled-list"></ul>
                    </div>
                </div>
                <div id="tab-patho" class="tab-content">
                    <div class="info-card">
                        <h4>ğŸ§¬ æ©Ÿè½‰</h4>
                        <p id="txt-patho" class="text-body"></p>
                    </div>
                    <div class="info-card mt-10">
                        <h4>ğŸ” æˆå› </h4>
                        <ul id="list-causes" class="styled-list"></ul>
                    </div>
                </div>
                <div id="tab-rx" class="tab-content">
                    <div class="info-card">
                        <h4>ğŸ’Š ACLS / Rx</h4>
                        <ul id="list-rx" class="styled-list list-rx"></ul>
                    </div>
                    <div class="info-card mt-10">
                        <h4>â¤ï¸ Nursing</h4>
                        <ul id="list-nurse" class="styled-list list-nurse"></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<div id="info-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header"><span>System Info</span><span class="close-btn" onclick="closeModal()">âœ•</span></div>
        <div class="modal-body">
            <p><strong>ECG Pro Simulator V12.0</strong></p>
            <p>User: <span id="modal-user-name">--</span></p>
            <hr>
            <p style="font-size:0.8rem; opacity:0.7;">åƒ…ä¾›æ•™å­¸ä½¿ç”¨ã€‚</p>
        </div>
    </div>
</div>

<script src="data.js"></script>
<script src="script.js"></script>
</body>
</html>
