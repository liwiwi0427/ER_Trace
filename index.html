<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECG Pro Ultimate UI</title>
    
    <!-- 1. ËºâÂÖ• CSS Ê®£ÂºèË°® -->
    <link rel="stylesheet" href="style.css">

    <!-- 2. ÂÆâÂÖ®Ê™¢Êü•ÔºöÂ¶ÇÊûúÊ≤íÁôªÂÖ•ÂâáË∏¢Âõû -->
    <script>
        if (!localStorage.getItem('ecg_username')) {
            window.location.replace('login.html');
        }
    </script>
</head>
<body>

<!-- Â∑¶ÂÅ¥ÈÅ∏ÂñÆÊ¨Ñ -->
<aside>
    <div class="brand">‚ö° ECG Pro <span>V12</span></div>
    
    <!-- ‰∏ªÈ°åÈÅ∏Êìá -->
    <div class="theme-selector">
        <label>üé® ‰ªãÈù¢È¢®Ê†º (Theme)</label>
        <select id="themeSelect" onchange="changeTheme(this.value)">
            <option value="dark">üè• Â∞àÊ•≠ÈÜ´ÁôÇÈªë (Dark)</option>
            <option value="light">‚òÄÔ∏è Êó•ÈñìÁóÖÊàøÁôΩ (Light)</option>
            <option value="retro">üì∫ Âæ©Âè§Ëû¢ÂÖâÁ∂† (Retro)</option>
            <option value="cyber">ü§ñ Ë≥ΩÂçöÈæêÂÖã (Cyber)</option>
        </select>
    </div>

    <!-- Â∞éËà™ÊåâÈàï (Keys ÂøÖÈ†àÂ∞çÊáâ data.js) -->
    <div class="nav-scroll">
        <div class="cat-header">SINUS (Á´áÊÄß)</div>
        <div class="nav-btn active" onclick="loadCase('nsr')"><span>NSR</span><div class="dot norm"></div></div>
        <div class="nav-btn" onclick="loadCase('sb')"><span>Sinus Brady</span><div class="dot norm"></div></div>
        
        <div class="cat-header">ATRIAL (ÊàøÊÄß)</div>
        <div class="nav-btn" onclick="loadCase('psvt')"><span>PSVT</span><div class="dot warn"></div></div>
        <div class="nav-btn" onclick="loadCase('afib')"><span>AFib</span><div class="dot warn"></div></div>
        <div class="nav-btn" onclick="loadCase('afl')"><span>A-Flutter</span><div class="dot warn"></div></div>

        <div class="cat-header">VENTRICULAR (ÂÆ§ÊÄß)</div>
        <div class="nav-btn" onclick="loadCase('pvc')"><span>PVC</span><div class="dot warn"></div></div>
        <div class="nav-btn" onclick="loadCase('vt')"><span>VT (Pulse)</span><div class="dot crit"></div></div>
        <div class="nav-btn" onclick="loadCase('pvt')"><span>pVT (No Pulse)</span><div class="dot crit"></div></div>
        <div class="nav-btn" onclick="loadCase('tdp')"><span>TdP</span><div class="dot crit"></div></div>
        <div class="nav-btn" onclick="loadCase('vf')"><span>VF</span><div class="dot crit"></div></div>

        <div class="cat-header">BLOCKS / ARREST</div>
        <div class="nav-btn" onclick="loadCase('avb1')"><span>1¬∞ AVB</span><div class="dot spec"></div></div>
        <div class="nav-btn" onclick="loadCase('avb2t1')"><span>2¬∞ Type I</span><div class="dot spec"></div></div>
        <div class="nav-btn" onclick="loadCase('avb2t2')"><span>2¬∞ Type II</span><div class="dot spec"></div></div>
        <div class="nav-btn" onclick="loadCase('avb3')"><span>3¬∞ AVB</span><div class="dot spec"></div></div>
        <div class="nav-btn" onclick="loadCase('pea')"><span>PEA</span><div class="dot crit"></div></div>
        <div class="nav-btn" onclick="loadCase('asystole')"><span>Asystole</span><div class="dot crit"></div></div>
    </div>

    <!-- Â∫ïÈÉ®ÂäüËÉΩ -->
    <div class="sidebar-footer">
        <button class="icon-btn" onclick="openModal()" title="System Info">‚ÑπÔ∏è</button>
        <button class="icon-btn" onclick="logout()" title="Logout" style="color:var(--st-crit);">üö™</button>
    </div>
</aside>

<!-- ‰∏ªÊìç‰ΩúÂçÄ -->
<main>
    <div class="top-deck">
        <!-- A. Áõ£Ë¶ñÂô®Ëû¢Âπï -->
        <div class="monitor-frame">
            <div class="monitor-screen">
                <div class="ecg-grid"></div>
                
                <!-- ÈñÉÂÖâÂ±§ (ÈõªÊìäÁî®) -->
                <div id="shock-flash" class="flash-overlay" style="opacity:0; transition:0.2s; position:absolute; inset:0; background:white; pointer-events:none;"></div>
                
                <!-- Áï´Â∏É -->
                <canvas id="ecgCanvas"></canvas>
                
                <!-- Ë¶ÜËìãË≥áË®ä -->
                <div class="monitor-overlay">
                    <div class="monitor-header">LEAD II <span class="monitor-mode">Monitor Mode</span></div>
                    <div id="user-staff-badge">Staff: --</div>
                </div>
                
                <!-- Ëó•Áâ©Áµ¶‰∫àÁ¥ÄÈåÑ -->
                <div class="med-log" id="med-log"></div>
            </div>
            
            <!-- B. ÁîüÂëΩÂæµË±°Êùø -->
            <div class="vitals-panel">
                <div class="vital-row c-hr">
                    <span class="lbl">HR</span>
                    <span class="val" id="val-hr">--</span>
                    <span class="unit">bpm</span>
                </div>
                <div class="vital-row c-bp">
                    <span class="lbl">NIBP</span>
                    <div class="val-group"><span id="val-sys">--</span>/<span id="val-dia">--</span></div>
                    <button class="nibp-btn" id="btn-nibp" onclick="runNIBP()">Ê∏¨Èáè (Start)</button>
                </div>
                <div class="vital-row c-spo2">
                    <span class="lbl">SpO2</span>
                    <span class="val" id="val-spo2">--</span>
                    <span class="unit">%</span>
                </div>
                <div class="vital-row c-rr">
                    <span class="lbl">RR</span>
                    <span class="val" id="val-rr">--</span>
                    <span class="unit">rpm</span>
                </div>
                <div class="vital-row c-temp">
                    <span class="lbl">TEMP</span>
                    <span class="val" id="val-temp">--</span>
                    <span class="unit">¬∞C</span>
                </div>
            </div>
        </div>

        <!-- C. ÊéßÂà∂Âè∞ (ÈõªÊìäËàáËó•Áâ©) -->
        <div class="control-panel">
            <div class="defib-section">
                <div class="energy-lcd"><span id="joules">200</span> J</div>
                <div class="defib-controls">
                    <button class="btn-defib btn-charge" id="btn-chg" onclick="charge()">CHARGE</button>
                    <button class="btn-defib btn-shock" id="btn-shk" onclick="shock()" disabled>SHOCK</button>
                </div>
            </div>
            <div class="meds-section">
                <div class="section-title">ACLS MEDS</div>
                <div class="meds-grid">
                    <button class="drug-btn d-epi" onclick="giveDrug('Epi 1mg')">Epi <span>1mg</span></button>
                    <button class="drug-btn d-amio" onclick="giveDrug('Amio 150mg')">Amio <span>150mg</span></button>
                    <button class="drug-btn d-aden" onclick="giveDrug('Adeno 6mg')">Adeno <span>6mg</span></button>
                    <button class="drug-btn d-atro" onclick="giveDrug('Atro 1mg')">Atro <span>1mg</span></button>
                    <button class="drug-btn d-mag" onclick="giveDrug('Mag 2g')">Mag <span>2g</span></button>
                </div>
            </div>
        </div>
    </div>

    <!-- D. ÊïôÂ≠∏ÂçÄ -->
    <div class="edu-container">
        <!-- 1. ÂøÉËáüËß£ÂâñÂãïÁï´ -->
        <div class="anatomy-box glass-panel anatomy-wrap">
            <div id="anat-tip" class="anat-tip" style="position:absolute; top:10px; left:15px;">
                Interactive Heart View
            </div>
            
            <svg class="heart-svg" viewBox="0 0 300 350" style="overflow:visible;">
                <!-- ÂøÉËÇåÂ∫ïÂúñ -->
                <path id="h-muscle" class="path-heart" d="M150 330 C 50 300, 20 180, 20 120 C 20 60, 80 20, 150 90 C 220 20, 280 60, 280 120 C 280 180, 250 300, 150 330 Z" />
                
                <!-- ÂÇ≥Â∞éË∑ØÂæë (ÈáçË¶ÅID) -->
                <!-- Ë∑ØÂæë1: Internodal (SA to AV) -->
                <path id="p-internodal" class="path-conduction" d="M80 80 Q 115 110 150 140" data-name="Internodal Pathways (ÁµêÈñìË∑ØÂæë)" />
                <!-- Ë∑ØÂæë2: Bundle of His -->
                <path id="p-his" class="path-conduction" d="M150 140 L 150 175" data-name="Bundle of His (Â∏åÊ∞èÊùü)" />
                <!-- Ë∑ØÂæë3: Bundle Branches / Purkinje -->
                <path id="p-branches" class="path-conduction" d="M150 175 L 100 260 M 150 175 L 200 260" data-name="Purkinje / Bundle Branches" />
                
                <!-- ÁØÄÈªû -->
                <circle id="n-sa" class="node" cx="80" cy="80" r="9" data-name="SA Node (Á´áÊàøÁµê)" />
                <circle id="n-av" class="node" cx="150" cy="140" r="8" data-name="AV Node (ÊàøÂÆ§Áµê)" />
                
                <!-- Áï∞Â∏∏Ê®ôÁ§∫ (È†êË®≠Èö±Ëóè) -->
                <rect id="vis-block" class="block-bar" x="135" y="145" width="30" height="8" rx="2" style="display:none;" />
                <circle id="vis-reentry" class="reentry-ring" cx="150" cy="140" r="15" style="display:none; fill:none; stroke:#ff0;" />
                <g id="vis-tdp" style="display:none;">
                    <circle class="flash-dot" cx="120" cy="220" r="6" />
                    <circle class="flash-dot" cx="180" cy="250" r="6" style="animation-delay:0.2s" />
                </g>
            </svg>
        </div>

        <!-- 2. ÊñáÂ≠óË≥áË®äÂç°Áâá -->
        <div class="content-box glass-panel">
            <div class="content-header">
                <div class="rhythm-title" id="txt-title">Loading...</div>
                <span class="rhythm-tag" id="txt-tag">--</span>
            </div>
            
            <div class="tabs">
                <button class="tab-btn active" onclick="openTab('1')">Criteria (Âà§ËÆÄ)</button>
                <button class="tab-btn" onclick="openTab('2')">Pathology (ÁóÖÁêÜ)</button>
                <button class="tab-btn" onclick="openTab('3')">Rx & Care (ËôïÁΩÆ)</button>
            </div>
            
            <div class="tab-viewport">
                <!-- Tab 1: Criteria -->
                <div id="t1" class="tab-content active">
                    <div id="alert-banner" style="display:none;"></div>
                    <div class="info-card">
                        <h4>üìã ÁâπÂæµ FEATURES</h4>
                        <ul class="styled-list" id="list-cri"></ul>
                    </div>
                </div>
                <!-- Tab 2: Patho -->
                <div id="t2" class="tab-content">
                    <p id="txt-patho" class="text-body"></p>
                    <div class="info-card mt-10">
                        <h4>üîç ÊàêÂõ† CAUSES</h4>
                        <ul class="styled-list" id="list-cause"></ul>
                    </div>
                </div>
                <!-- Tab 3: Rx -->
                <div id="t3" class="tab-content">
                    <div class="info-card">
                        <h4>üíä ACLS PROTOCOL</h4>
                        <ul class="styled-list list-rx" id="list-rx"></ul>
                    </div>
                    <div class="info-card mt-10">
                        <h4>‚ö° NURSING PRIORITY</h4>
                        <ul class="styled-list list-nurse" id="list-nur"></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Á≥ªÁµ±Ë≥áË®äË¶ñÁ™ó -->
<div id="info-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header"><span>System Info</span><span class="close-btn" onclick="closeModal()">‚úï</span></div>
        <div class="modal-body">
            <p><strong>ECG Pro Simulator V12.0</strong></p>
            <p>Current User: <span id="modal-user-name">--</span></p>
            <hr style="margin:15px 0; border-top:1px solid #444;">
            <p style="font-size:0.8rem; opacity:0.7;">ÂÉÖ‰æõÈÜ´Â≠∏ÊïôËÇ≤ËàáÊºîÁ∑¥‰ΩøÁî®ÔºåÈùûÈÜ´ÁôÇÂô®Êùê„ÄÇ</p>
        </div>
    </div>
</div>

<!-- 3. ËºâÂÖ•ËÖ≥Êú¨ÔºöÈ†ÜÂ∫èÂæàÈáçË¶ÅÔºÅData ÂøÖÈ†àÂÖàÊñº Logic -->
<script src="data.js"></script>
<script src="script.js"></script>

</body>
</html>
