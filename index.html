<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECG Pro Workspace</title>
    <link rel="stylesheet" href="style.css">
    <script>if(!localStorage.getItem('ecg_username')) location.href='login.html';</script>
</head>
<body>

<aside>
    <div class="brand">‚ö° ECG Pro <span class="badge" style="float:right;">V12.0</span></div>
    
    <div class="theme-box" style="padding:10px; border-bottom:1px solid var(--border-col);">
        <select id="theme-select" onchange="ThemeManager.setTheme(this.value)">
            <option value="dark">Clinical Dark</option>
            <option value="light">Ward Light</option>
            <option value="retro">Retro CRT</option>
            <option value="cyber">Cyberpunk</option>
        </select>
    </div>

    <!-- Script Â∞áËá™ÂãïÂ°´ÂÖÖÈÄôË£°Ôºå‰ΩÜÊàëÂÖàÂØ´Ê≠ªÁµêÊßã‰ª•Á¢∫‰øùÊÇ®È¶¨‰∏äÂèØÁî® -->
    <div class="nav-scroll" id="menu">
        <!-- JS ÊúÉÁî¢ÁîüÈÅ∏ÂñÆ -->
    </div>
    
    <div class="footer">
        <button class="icon-btn" onclick="toggleSettings()">‚öôÔ∏è</button>
        <button class="icon-btn" onclick="logout()" style="color:#f44336;">üö™</button>
    </div>
</aside>

<main>
    <div class="top-deck">
        <div class="monitor-group">
            <div class="screen">
                <div class="ecg-grid"></div>
                <div class="overlay">
                    <div style="color:var(--c-hr); font-weight:bold;">LEAD II</div>
                    <div id="staff-name" style="color:var(--c-spo2); opacity:0.8; font-size:0.8rem;">--</div>
                </div>
                <div id="med-log" style="position:absolute; right:10px; top:10px; text-align:right; pointer-events:none;"></div>
                <div id="flash" style="position:absolute; inset:0; background:#fff; opacity:0; pointer-events:none;"></div>
                <canvas id="ecgCanvas"></canvas>
            </div>
            <!-- Vitals: NIBP White, SpO2 Blue... -->
            <div class="vitals">
                <div class="v-row c-hr">
                    <span class="v-lbl">HR</span><span class="v-val" id="val-hr">--</span><span class="v-unit">bpm</span>
                </div>
                <div class="v-row c-bp">
                    <span class="v-lbl">NIBP</span>
                    <span class="v-val" style="font-size:1.5rem;"><span id="val-sys">--</span>/<span id="val-dia">--</span></span>
                    <button class="nibp-btn" id="btn-nibp" onclick="runNIBP()">Ê∏¨Èáè (Start)</button>
                </div>
                <div class="v-row c-spo2">
                    <span class="v-lbl">SpO2</span><span class="v-val" id="val-spo2">--</span><span class="v-unit">%</span>
                </div>
                <div class="v-row c-rr">
                    <span class="v-lbl">RR</span><span class="v-val" id="val-rr">--</span><span class="v-unit">rpm</span>
                </div>
                <div class="v-row c-temp">
                    <span class="v-lbl">TEMP</span><span class="v-val" id="val-temp">--</span><span class="v-unit">¬∞C</span>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="defib-wrap">
                <div class="lcd"><span id="joules">200</span> J</div>
                <div class="btn-grid">
                    <button class="action-btn b-chg" id="btn-chg" onclick="charge()">CHARGE</button>
                    <button class="action-btn b-shk" id="btn-shk" onclick="shock()" disabled>SHOCK</button>
                </div>
            </div>
            <div class="meds-list">
                <div class="cat-title">DRUGS</div>
                <button class="drug-btn" style="border-left-color:var(--drug-epi)" onclick="drug('Epinephrine 1mg')">Epi 1mg</button>
                <button class="drug-btn" style="border-left-color:var(--drug-amio)" onclick="drug('Amiodarone 150mg')">Amio 150mg</button>
                <button class="drug-btn" style="border-left-color:var(--drug-aden)" onclick="drug('Adenosine 6mg')">Adeno 6mg</button>
                <button class="drug-btn" style="border-left-color:var(--drug-atro)" onclick="drug('Atropine 1mg')">Atro 1mg</button>
                <button class="drug-btn" style="border-left-color:var(--drug-mag)" onclick="drug('Magnesium 2g')">Mag 2g</button>
            </div>
        </div>
    </div>

    <div class="edu-deck">
        <!-- Anatomy -->
        <div class="panel anatomy-box">
            <div style="position:absolute; top:10px; left:10px; color:#aaa; font-size:0.8rem; z-index:10;" id="anat-tip">
                Interactive Heart View
            </div>
            <div class="svg-wrap">
                <svg viewBox="0 0 300 350" style="height:100%; width:100%; overflow:visible;">
                    <path class="path-muscle" d="M150 330 C 50 300, 20 180, 20 120 C 20 60, 80 20, 150 90 C 220 20, 280 60, 280 120 C 280 180, 250 300, 150 330 Z" />
                    <!-- Ë∑ØÂæë ID ÈùûÂ∏∏ÈáçË¶Å -->
                    <path id="path-sa-av" class="path-wire" d="M80 80 Q 115 110 150 140" data-name="Internodal Pathway (ÁµêÈñìË∑ØÂæë)" />
                    <path id="path-his" class="path-wire" d="M150 140 L 150 175" data-name="Bundle of His (Â∏åÊ∞èÊùü)" />
                    <path id="path-branches" class="path-wire" d="M150 175 L 100 260 M 150 175 L 200 260" data-name="Bundle Branches (ÊùüÊîØ)" />
                    <!-- ÁØÄÈªû -->
                    <circle id="node-sa" class="node" cx="80" cy="80" r="8" data-name="SA Node (Á´áÊàøÁµê)"/>
                    <circle id="node-av" class="node" cx="150" cy="140" r="7" data-name="AV Node (ÊàøÂÆ§Áµê)"/>
                    
                    <rect id="vis-block" x="135" y="145" width="30" height="8" fill="red" style="display:none;"/>
                    <circle id="vis-reentry" cx="150" cy="140" r="15" fill="none" stroke="yellow" stroke-width="2" stroke-dasharray="4" style="display:none;"/>
                </svg>
            </div>
        </div>

        <!-- Text Info -->
        <div class="panel">
            <div style="padding:15px; border-bottom:1px solid var(--border-col); display:flex; justify-content:space-between;">
                <b id="txt-title" style="color:var(--c-hr); font-size:1.2rem;">--</b>
                <span id="txt-tag" style="background:#444; color:#fff; padding:2px 8px; border-radius:4px; font-size:0.7rem;">--</span>
            </div>
            <div class="tabs">
                <button class="tab active" onclick="showTab(1)">Âà§ËÆÄ Criteria</button>
                <button class="tab" onclick="showTab(2)">ÁóÖÁêÜ Patho</button>
                <button class="tab" onclick="showTab(3)">ËôïÁΩÆ Rx</button>
            </div>
            <div class="content-area">
                <div id="t1" class="content-pane active">
                    <div id="alert-box" style="padding:10px; margin-bottom:10px; border:2px solid red; color:red; display:none; text-align:center; font-weight:bold;"></div>
                    <ul class="styled" id="list-cri"></ul>
                </div>
                <div id="t2" class="content-pane">
                    <p id="txt-patho" style="margin-bottom:15px;"></p>
                    <h4 style="color:var(--c-spo2); border-bottom:1px solid #333; margin-bottom:5px;">ÊàêÂõ† Causes</h4>
                    <ul class="styled" id="list-cause"></ul>
                </div>
                <div id="t3" class="content-pane">
                    <h4 style="color:#ff3333; border-bottom:1px solid #333; margin-bottom:5px;">ACLS Âª∫Ë≠∞</h4>
                    <ul class="styled" id="list-rx"></ul>
                    <h4 style="color:#ffff00; border-bottom:1px solid #333; margin:15px 0 5px 0;">Ë≠∑ÁêÜÈáçÈªû</h4>
                    <ul class="styled" id="list-nur"></ul>
                </div>
            </div>
        </div>
    </div>
</main>

<script src="theme.js"></script>
<!-- Ë´ãÁ¢∫‰øù data.js Âú® script.js ‰πãÂâç -->
<script src="data.js"></script>
<script src="script.js"></script>
<script src="admin.js"></script>
</body>
</html>